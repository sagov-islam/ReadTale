"use strict";import HideIt from"./HideIt.min.js";import ShowIt from"./ShowIt.min.js";import Comment from"./Comment.min.js";import Slicer from"./Slicer.min.js";import Modal from"./Modal.min.js";import ReturnHTML from"./ReturnHTML.min.js";const currentBookId=+localStorage.getItem("currentBookId");let bookInformation;function addBookInformation(){$.get("../database/books/information.json",{},(t=>{$(t).each(((t,e)=>{e.id===currentBookId&&(bookInformation=e)}));const e=bookInformation.genres.map((t=>`<li class="rt-tags__item">${t}</li>`)),o=String(bookInformation.stars);let n=1===o.length?`${o}.0`:o,s="";for(let t=1;t<=10;t++)s+=`\n                <li class="rt-stars__item ${t<=bookInformation.stars?"checked":""}">\n                   <svg width="31" height="30" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="m15.5 0 4.79 9.874L31 11.467l-7.75 7.681L25.079 30 15.5 24.874 5.921 30 7.75 19.148 0 11.467l10.71-1.593L15.5 0Z"/></svg>\n                </li>\n                `;$("#bookInfo").html(ReturnHTML.bookInformation({image:bookInformation.image,author:bookInformation.author,name:bookInformation.name,synopsis:bookInformation.synopsis,genres:e,stars:{html:s,number:n}}))}))}addBookInformation(),$((()=>{new HideIt({selector:".rt-loader__content",px:"50px",seconds:.5,callback:()=>{$(".rt-loader").remove();new ShowIt({selector:"header, footer, section",seconds:.5}).smoothShow()}}).smoothHideY(),$(".rt-tabs__lines-orange").css({width:$("#comments").width(),left:$("#comments").position().left}),$(".rt-tabs__item").each(((t,e)=>{$(e).on("click",(()=>{$("input",e).is(":checked")&&$(".rt-tabs__lines-orange").css({width:$(e).width(),left:$(e).position().left})}))})),$("#chapters-container").hide();const t=$(".rt-tabs__item");function e(t,e){new HideIt({selector:t,px:"0px",seconds:.2,callback:()=>{$(t).hide(),$(e).show(),new ShowIt({selector:e,seconds:.2}).smoothShow()}}).smoothHideY()}$("input",t).change((()=>{t.each(((t,o)=>{const n=$("input",o);$(n).is(":checked")&&("chapters"!==o.id?"comments"!==o.id||e("#chapters-container","#comments-container"):e("#comments-container","#chapters-container"))}))}));const o=new Slicer([],{start:0,end:5});let n=!1;Comment.dynamicTextareaHeight(),$("#main-textarea").on("submit",(function(t){t.preventDefault();const e=$("textarea",$(this));o.data.push(new Comment({name:"Гость",date:(new Date).toLocaleDateString(),text:e.val(),img:"./images/guest.png"})),o.indexes.end>=o.data.length&&(n=!0),n&&(o.indexes={start:o.data.length-1,end:o.data.length},o.addSlicedComments("#main-comments"),ShowIt.smoothShowSlicedElements(".rt-comments > .rt-comment",o.indexes,.5))}));const s=[];$.get("../database/comments/comments.json",{},(t=>{$(t).each(((t,e)=>{e.bookId===currentBookId&&s.push(new Comment(e))})),o.data=s,o.addSlicedComments(".rt-comments"),ShowIt.smoothShowSlicedElements(".rt-comment",o.indexes,.5)})),$("button#show-more-comments").on("click",(()=>{o.indexes={start:o.indexes.end,end:o.indexes.end+5},o.addSlicedComments(".rt-comments"),ShowIt.smoothShowSlicedElements(".rt-comment",o.indexes,.5),o.indexes.end<=o.data.length||(n=!0)})),$(".rt-chapter__link").on("click",(function(t){t.preventDefault();const e=$(".rt-chapter__num",$(this)).text();localStorage.setItem("chapterNum",e),document.location.href="chapter.html"})),new Modal({stars:!0,name:"grade"}).create()}));
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJvb2subWluLmpzIl0sIm5hbWVzIjpbIkhpZGVJdCIsIlNob3dJdCIsIkNvbW1lbnQiLCJTbGljZXIiLCJNb2RhbCIsIlJldHVybkhUTUwiLCJjdXJyZW50Qm9va0lkIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsImJvb2tJbmZvcm1hdGlvbiIsImFkZEJvb2tJbmZvcm1hdGlvbiIsIiQiLCJnZXQiLCJkYXRhIiwiZWFjaCIsImluZGV4IiwiYm9vayIsImlkIiwiZ2VucmVzIiwibWFwIiwiZ2VucmUiLCJzdGFycyIsIlN0cmluZyIsInN0YXJzTnVtYmVyIiwibGVuZ3RoIiwic3RhcnNIdG1sIiwiaSIsImh0bWwiLCJpbWFnZSIsImF1dGhvciIsIm5hbWUiLCJzeW5vcHNpcyIsIm51bWJlciIsInNlbGVjdG9yIiwicHgiLCJzZWNvbmRzIiwiY2FsbGJhY2siLCJyZW1vdmUiLCJzbW9vdGhTaG93Iiwic21vb3RoSGlkZVkiLCJjc3MiLCJ3aWR0aCIsImxlZnQiLCJwb3NpdGlvbiIsInRhYiIsIm9uIiwiaXMiLCJoaWRlIiwidGFicyIsImhpZGVTaG93VGFic0NvbnRlbnQiLCJoaWRlRWxlbWVudCIsInNob3dFbGVtZW50Iiwic2hvdyIsImNoYW5nZSIsImlucHV0Iiwic2xpY2VyIiwic3RhcnQiLCJlbmQiLCJhbGxTaG93ZWQiLCJkeW5hbWljVGV4dGFyZWFIZWlnaHQiLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwidGV4dGFyZWEiLCJ0aGlzIiwicHVzaCIsImRhdGUiLCJEYXRlIiwidG9Mb2NhbGVEYXRlU3RyaW5nIiwidGV4dCIsInZhbCIsImltZyIsImluZGV4ZXMiLCJhZGRTbGljZWRDb21tZW50cyIsInNtb290aFNob3dTbGljZWRFbGVtZW50cyIsImNvbW1lbnRzIiwiY29tbWVudFByb3BzIiwiYm9va0lkIiwiY2hhcHRlck51bSIsInNldEl0ZW0iLCJkb2N1bWVudCIsImxvY2F0aW9uIiwiaHJlZiIsImNyZWF0ZSJdLCJtYXBwaW5ncyI6IkFBQUEsb0JBRU9BLFdBQVkseUJBQ1pDLFdBQVkseUJBQ1pDLFlBQWEsMEJBQ2JDLFdBQVkseUJBQ1pDLFVBQVcsd0JBQ1hDLGVBQWdCLHNCQUV2QixNQUFNQyxlQUFpQkMsYUFBYUMsUUFBUSxpQkFDNUMsSUFBSUMsZ0JBRUosU0FBU0MscUJBQ0xDLEVBQUVDLElBQUkscUNBQXNDLElBQUtDLElBQzdDRixFQUFFRSxHQUFNQyxNQUFLLENBQUNDLEVBQU9DLEtBQ2JBLEVBQUtDLEtBQU9YLGdCQUNoQkcsZ0JBQWtCTyxNQUd0QixNQUFNRSxFQUFTVCxnQkFBZ0JTLE9BQU9DLEtBQUtDLEdBQVUsNkJBQTZCQSxXQUM1RUMsRUFBUUMsT0FBT2IsZ0JBQWdCWSxPQUNyQyxJQUFJRSxFQUErQixJQUFqQkYsRUFBTUcsT0FBZSxHQUFHSCxNQUFZQSxFQUVsREksRUFBWSxHQUNoQixJQUFLLElBQUlDLEVBQUksRUFBR0EsR0FBSyxHQUFJQSxJQUNqQkQsR0FBYSwrQ0FDZUMsR0FBS2pCLGdCQUFnQlksTUFBUSxVQUFZLGtSQU03RVYsRUFBRSxhQUFhZ0IsS0FBS3RCLFdBQVdJLGdCQUFnQixDQUMzQ21CLE1BQU9uQixnQkFBZ0JtQixNQUN2QkMsT0FBUXBCLGdCQUFnQm9CLE9BQ3hCQyxLQUFNckIsZ0JBQWdCcUIsS0FDdEJDLFNBQVV0QixnQkFBZ0JzQixTQUMxQmIsT0FBUUEsRUFDUkcsTUFBTyxDQUNITSxLQUFNRixFQUNOTyxPQUFRVCxTQU94QmIscUJBRUFDLEdBQUUsS0FHa0IsSUFBSVgsT0FBTyxDQUN2QmlDLFNBQVUsc0JBQ1ZDLEdBQUksT0FDSkMsUUFBUyxHQUNUQyxTQUFVLEtBQ056QixFQUFFLGNBQWMwQixTQUVELElBQUlwQyxPQUFPLENBQUVnQyxTQUFVLDBCQUEyQkUsUUFBUyxLQUNuRUcsZ0JBR1BDLGNBS1I1QixFQUFFLDBCQUEwQjZCLElBQUksQ0FDNUJDLE1BQU85QixFQUFFLGFBQWE4QixRQUN0QkMsS0FBTS9CLEVBQUUsYUFBYWdDLFdBQVdELE9BR3BDL0IsRUFBRSxrQkFBa0JHLE1BQUssQ0FBQ0MsRUFBTzZCLEtBQzdCakMsRUFBRWlDLEdBQUtDLEdBQUcsU0FBUyxLQUNWbEMsRUFBRSxRQUFTaUMsR0FBS0UsR0FBRyxhQUV4Qm5DLEVBQUUsMEJBQTBCNkIsSUFBSSxDQUM1QkMsTUFBTzlCLEVBQUVpQyxHQUFLSCxRQUNkQyxLQUFNL0IsRUFBRWlDLEdBQUtELFdBQVdELGFBUXBDL0IsRUFBRSx1QkFBdUJvQyxPQUV6QixNQUFNQyxFQUFPckMsRUFBRSxrQkFFZixTQUFTc0MsRUFBb0JDLEVBQWFDLEdBQ3RDLElBQUluRCxPQUFPLENBQ1BpQyxTQUFVaUIsRUFDVmhCLEdBQUksTUFDSkMsUUFBUyxHQUNUQyxTQUFVLEtBQ056QixFQUFFdUMsR0FBYUgsT0FDZnBDLEVBQUV3QyxHQUFhQyxPQUNmLElBQUluRCxPQUFPLENBQ1BnQyxTQUFVa0IsRUFDVmhCLFFBQVMsS0FDVkcsZ0JBRVJDLGNBZFE1QixFQUFFLFFBQVVxQyxHQWtCcEJLLFFBQU8sS0FDVkwsRUFBS2xDLE1BQUssQ0FBQ0MsRUFBTzZCLEtBRWQsTUFBTVUsRUFBUzNDLEVBQUUsUUFBU2lDLEdBQ25CakMsRUFBRTJDLEdBQU9SLEdBQUcsY0FFSixhQUFYRixFQUFJM0IsR0FLTyxhQUFYMkIsRUFBSTNCLElBQ0pnQyxFQUFvQixzQkFBdUIsdUJBTDNDQSxFQUFvQixzQkFBdUIsOEJBYXZELE1BQU1NLEVBQVMsSUFBSXBELE9BQU8sR0FBSSxDQUFFcUQsTUFBTyxFQUFHQyxJQUFLLElBQy9DLElBQUlDLEdBQVksRUFHaEJ4RCxRQUFReUQsd0JBQ1JoRCxFQUFFLGtCQUFrQmtDLEdBQUcsVUFBVSxTQUFTZSxHQUN0Q0EsRUFBTUMsaUJBRU4sTUFBTUMsRUFBV25ELEVBQUUsV0FBWUEsRUFBRW9ELE9BRWpDUixFQUFPMUMsS0FBS21ELEtBQUssSUFBSTlELFFBQVEsQ0FDekI0QixLQUFNLFFBQ05tQyxNQUFNLElBQUlDLE1BQU9DLHFCQUNqQkMsS0FBTU4sRUFBU08sTUFDZkMsSUFBSyx3QkFFTGYsRUFBT2dCLFFBQVFkLEtBQU9GLEVBQU8xQyxLQUFLVyxTQUFRa0MsR0FBWSxHQUNuREEsSUFHUEgsRUFBT2dCLFFBQVUsQ0FBRWYsTUFBT0QsRUFBTzFDLEtBQUtXLE9BQVMsRUFBR2lDLElBQUtGLEVBQU8xQyxLQUFLVyxRQUNuRStCLEVBQU9pQixrQkFBa0Isa0JBQ3pCdkUsT0FBT3dFLHlCQUF5Qiw2QkFBOEJsQixFQUFPZ0IsUUFBUyxRQUtsRixNQUFNRyxFQUFXLEdBQ2pCL0QsRUFBRUMsSUFBSSxxQ0FBc0MsSUFBS0MsSUFFN0NGLEVBQUVFLEdBQU1DLE1BQUssQ0FBQ0MsRUFBTzRELEtBQ2JBLEVBQWFDLFNBQVd0RSxlQUM1Qm9FLEVBQVNWLEtBQUssSUFBSTlELFFBQVF5RSxPQUc5QnBCLEVBQU8xQyxLQUFPNkQsRUFDZG5CLEVBQU9pQixrQkFBa0IsZ0JBQ3pCdkUsT0FBT3dFLHlCQUF5QixjQUFlbEIsRUFBT2dCLFFBQVMsT0FPbkU1RCxFQUFFLDZCQUE2QmtDLEdBQUcsU0FBUyxLQUN2Q1UsRUFBT2dCLFFBQVUsQ0FBRWYsTUFBT0QsRUFBT2dCLFFBQVFkLElBQUtBLElBQUtGLEVBQU9nQixRQUFRZCxJQUFNLEdBQ3hFRixFQUFPaUIsa0JBQWtCLGdCQUN6QnZFLE9BQU93RSx5QkFBeUIsY0FBZWxCLEVBQU9nQixRQUFTLElBRTNEaEIsRUFBT2dCLFFBQVFkLEtBQU9GLEVBQU8xQyxLQUFLVyxTQUN0Q2tDLEdBQVksTUFJaEIvQyxFQUFFLHFCQUFxQmtDLEdBQUcsU0FBUyxTQUFTZSxHQUN4Q0EsRUFBTUMsaUJBRU4sTUFBTWdCLEVBQWFsRSxFQUFFLG1CQUFvQkEsRUFBRW9ELE9BQU9LLE9BQ2xEN0QsYUFBYXVFLFFBQVEsYUFBY0QsR0FFbkNFLFNBQVNDLFNBQVNDLEtBQU8sa0JBSzdCLElBQUk3RSxNQUFNLENBQ05pQixPQUFPLEVBQ1BTLEtBQU0sVUFDUG9EIiwiZmlsZSI6ImJvb2subWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xyXG5cclxuaW1wb3J0IEhpZGVJdCBmcm9tICcuL0hpZGVJdC5taW4uanMnO1xyXG5pbXBvcnQgU2hvd0l0IGZyb20gJy4vU2hvd0l0Lm1pbi5qcyc7XHJcbmltcG9ydCBDb21tZW50IGZyb20gJy4vQ29tbWVudC5taW4uanMnO1xyXG5pbXBvcnQgU2xpY2VyIGZyb20gJy4vU2xpY2VyLm1pbi5qcyc7XHJcbmltcG9ydCBNb2RhbCBmcm9tICcuL01vZGFsLm1pbi5qcyc7XHJcbmltcG9ydCBSZXR1cm5IVE1MIGZyb20gJy4vUmV0dXJuSFRNTC5taW4uanMnO1xyXG5cclxuY29uc3QgY3VycmVudEJvb2tJZCA9ICtsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY3VycmVudEJvb2tJZCcpO1xyXG5sZXQgYm9va0luZm9ybWF0aW9uO1xyXG5cclxuZnVuY3Rpb24gYWRkQm9va0luZm9ybWF0aW9uKCkge1xyXG4gICAgJC5nZXQoJy4uL2RhdGFiYXNlL2Jvb2tzL2luZm9ybWF0aW9uLmpzb24nLCB7fSwgKGRhdGEpID0+IHtcclxuICAgICAgICAkKGRhdGEpLmVhY2goKGluZGV4LCBib29rKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChib29rLmlkICE9PSBjdXJyZW50Qm9va0lkKSByZXR1cm5cclxuICAgICAgICAgICAgYm9va0luZm9ybWF0aW9uID0gYm9va1xyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIGNvbnN0IGdlbnJlcyA9IGJvb2tJbmZvcm1hdGlvbi5nZW5yZXMubWFwKChnZW5yZSkgPT4gYDxsaSBjbGFzcz1cInJ0LXRhZ3NfX2l0ZW1cIj4ke2dlbnJlfTwvbGk+YCk7XHJcbiAgICAgICAgY29uc3Qgc3RhcnMgPSBTdHJpbmcoYm9va0luZm9ybWF0aW9uLnN0YXJzKTtcclxuICAgICAgICBsZXQgc3RhcnNOdW1iZXIgPSBzdGFycy5sZW5ndGggPT09IDEgPyBgJHtzdGFyc30uMGAgOiBzdGFycztcclxuXHJcbiAgICAgICAgbGV0IHN0YXJzSHRtbCA9ICcnO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IDEwOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHN0YXJzSHRtbCArPSBgXHJcbiAgICAgICAgICAgICAgICA8bGkgY2xhc3M9XCJydC1zdGFyc19faXRlbSAke2kgPD0gYm9va0luZm9ybWF0aW9uLnN0YXJzID8gJ2NoZWNrZWQnIDogJyd9XCI+XHJcbiAgICAgICAgICAgICAgICAgICA8c3ZnIHdpZHRoPVwiMzFcIiBoZWlnaHQ9XCIzMFwiIGZpbGw9XCJub25lXCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPjxwYXRoIGQ9XCJtMTUuNSAwIDQuNzkgOS44NzRMMzEgMTEuNDY3bC03Ljc1IDcuNjgxTDI1LjA3OSAzMCAxNS41IDI0Ljg3NCA1LjkyMSAzMCA3Ljc1IDE5LjE0OCAwIDExLjQ2N2wxMC43MS0xLjU5M0wxNS41IDBaXCIvPjwvc3ZnPlxyXG4gICAgICAgICAgICAgICAgPC9saT5cclxuICAgICAgICAgICAgICAgIGBcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICQoJyNib29rSW5mbycpLmh0bWwoUmV0dXJuSFRNTC5ib29rSW5mb3JtYXRpb24oe1xyXG4gICAgICAgICAgICBpbWFnZTogYm9va0luZm9ybWF0aW9uLmltYWdlLFxyXG4gICAgICAgICAgICBhdXRob3I6IGJvb2tJbmZvcm1hdGlvbi5hdXRob3IsXHJcbiAgICAgICAgICAgIG5hbWU6IGJvb2tJbmZvcm1hdGlvbi5uYW1lLFxyXG4gICAgICAgICAgICBzeW5vcHNpczogYm9va0luZm9ybWF0aW9uLnN5bm9wc2lzLFxyXG4gICAgICAgICAgICBnZW5yZXM6IGdlbnJlcyxcclxuICAgICAgICAgICAgc3RhcnM6IHtcclxuICAgICAgICAgICAgICAgIGh0bWw6IHN0YXJzSHRtbCxcclxuICAgICAgICAgICAgICAgIG51bWJlcjogc3RhcnNOdW1iZXJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pKVxyXG4gICAgICAgIFxyXG4gICAgfSlcclxuXHJcbn1cclxuYWRkQm9va0luZm9ybWF0aW9uKCk7XHJcblxyXG4kKCgpID0+IHtcclxuXHJcbiAgICAvLyBTTU9PVEggU0hPVyAtLS0tPlxyXG4gICAgY29uc3Qgc3Bpbm5lciA9IG5ldyBIaWRlSXQoe1xyXG4gICAgICAgIHNlbGVjdG9yOiAnLnJ0LWxvYWRlcl9fY29udGVudCcsXHJcbiAgICAgICAgcHg6ICc1MHB4JyxcclxuICAgICAgICBzZWNvbmRzOiAwLjUsXHJcbiAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcclxuICAgICAgICAgICAgJCgnLnJ0LWxvYWRlcicpLnJlbW92ZSgpO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgYmxvY2tzID0gbmV3IFNob3dJdCh7IHNlbGVjdG9yOiAnaGVhZGVyLCBmb290ZXIsIHNlY3Rpb24nLCBzZWNvbmRzOiAwLjUgfSk7XHJcbiAgICAgICAgICAgIGJsb2Nrcy5zbW9vdGhTaG93KCk7ICAgIFxyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbiAgICBzcGlubmVyLnNtb290aEhpZGVZKCk7XHJcbiAgICAvLyA8LS0tLSBTTU9PVEggU0hPV1xyXG5cclxuXHJcbiAgICAvLyBUQUJTIC0tLS0+XHJcbiAgICAkKCcucnQtdGFic19fbGluZXMtb3JhbmdlJykuY3NzKHtcclxuICAgICAgICB3aWR0aDogJCgnI2NvbW1lbnRzJykud2lkdGgoKSxcclxuICAgICAgICBsZWZ0OiAkKCcjY29tbWVudHMnKS5wb3NpdGlvbigpLmxlZnRcclxuICAgIH0pXHJcbiAgIFxyXG4gICAgJCgnLnJ0LXRhYnNfX2l0ZW0nKS5lYWNoKChpbmRleCwgdGFiKSA9PiB7XHJcbiAgICAgICAgJCh0YWIpLm9uKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgaWYgKCEkKCdpbnB1dCcsIHRhYikuaXMoJzpjaGVja2VkJykpIHJldHVyblxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgJCgnLnJ0LXRhYnNfX2xpbmVzLW9yYW5nZScpLmNzcyh7XHJcbiAgICAgICAgICAgICAgICB3aWR0aDogJCh0YWIpLndpZHRoKCksXHJcbiAgICAgICAgICAgICAgICBsZWZ0OiAkKHRhYikucG9zaXRpb24oKS5sZWZ0XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuICAgIH0pIFxyXG4gICAgLy8gPC0tLS0gVEFCU1xyXG5cclxuXHJcbiAgICAvLyBUQUJTIENPTlRFTlQgLS0tLT5cclxuICAgICQoJyNjaGFwdGVycy1jb250YWluZXInKS5oaWRlKCk7XHJcblxyXG4gICAgY29uc3QgdGFicyA9ICQoJy5ydC10YWJzX19pdGVtJyk7XHJcbiAgICBjb25zdCBpbnB1dHMgPSAkKCdpbnB1dCcsICB0YWJzKTtcclxuICAgIGZ1bmN0aW9uIGhpZGVTaG93VGFic0NvbnRlbnQoaGlkZUVsZW1lbnQsIHNob3dFbGVtZW50KSB7XHJcbiAgICAgICAgbmV3IEhpZGVJdCh7XHJcbiAgICAgICAgICAgIHNlbGVjdG9yOiBoaWRlRWxlbWVudCxcclxuICAgICAgICAgICAgcHg6ICcwcHgnLFxyXG4gICAgICAgICAgICBzZWNvbmRzOiAwLjIsXHJcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAkKGhpZGVFbGVtZW50KS5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICAkKHNob3dFbGVtZW50KS5zaG93KCk7XHJcbiAgICAgICAgICAgICAgICBuZXcgU2hvd0l0KHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxlY3Rvcjogc2hvd0VsZW1lbnQsXHJcbiAgICAgICAgICAgICAgICAgICAgc2Vjb25kczogMC4yXHJcbiAgICAgICAgICAgICAgICB9KS5zbW9vdGhTaG93KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KS5zbW9vdGhIaWRlWSgpO1xyXG4gICAgICAgIHJldHVyblxyXG4gICAgfVxyXG5cclxuICAgIGlucHV0cy5jaGFuZ2UoKCkgPT4ge1xyXG4gICAgICAgIHRhYnMuZWFjaCgoaW5kZXgsIHRhYikgPT4ge1xyXG5cclxuICAgICAgICAgICAgY29uc3QgaW5wdXQgPSAgJCgnaW5wdXQnLCB0YWIpO1xyXG4gICAgICAgICAgICBpZiAoICEgJChpbnB1dCkuaXMoJzpjaGVja2VkJykpIHJldHVyblxyXG5cclxuICAgICAgICAgICAgaWYgKHRhYi5pZCA9PT0gJ2NoYXB0ZXJzJykge1xyXG4gICAgICAgICAgICAgICAgaGlkZVNob3dUYWJzQ29udGVudCgnI2NvbW1lbnRzLWNvbnRhaW5lcicsICcjY2hhcHRlcnMtY29udGFpbmVyJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHRhYi5pZCA9PT0gJ2NvbW1lbnRzJykge1xyXG4gICAgICAgICAgICAgICAgaGlkZVNob3dUYWJzQ29udGVudCgnI2NoYXB0ZXJzLWNvbnRhaW5lcicsICcjY29tbWVudHMtY29udGFpbmVyJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgXHJcbiAgICB9KVxyXG4gICAgLy8gPC0tLS0gVEFCUyBDT05URU5UXHJcblxyXG4gICAgY29uc3Qgc2xpY2VyID0gbmV3IFNsaWNlcihbXSwgeyBzdGFydDogMCwgZW5kOiA1IH0pO1xyXG4gICAgbGV0IGFsbFNob3dlZCA9IGZhbHNlO1xyXG4gICAgXHJcbiAgICAvLyBURVhUQVJFQSAtLS0tPlxyXG4gICAgQ29tbWVudC5keW5hbWljVGV4dGFyZWFIZWlnaHQoKTtcclxuICAgICQoJyNtYWluLXRleHRhcmVhJykub24oJ3N1Ym1pdCcsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgICAgY29uc3QgdGV4dGFyZWEgPSAkKCd0ZXh0YXJlYScsICQodGhpcykpO1xyXG5cclxuICAgICAgICBzbGljZXIuZGF0YS5wdXNoKG5ldyBDb21tZW50KHtcclxuICAgICAgICAgICAgbmFtZTogJ9CT0L7RgdGC0YwnLFxyXG4gICAgICAgICAgICBkYXRlOiBuZXcgRGF0ZSgpLnRvTG9jYWxlRGF0ZVN0cmluZygpLFxyXG4gICAgICAgICAgICB0ZXh0OiB0ZXh0YXJlYS52YWwoKSxcclxuICAgICAgICAgICAgaW1nOiAnLi9pbWFnZXMvZ3Vlc3QucG5nJ1xyXG4gICAgICAgIH0pKVxyXG4gICAgICAgIGlmIChzbGljZXIuaW5kZXhlcy5lbmQgPj0gc2xpY2VyLmRhdGEubGVuZ3RoKSBhbGxTaG93ZWQgPSB0cnVlOyAgIFxyXG4gICAgICAgIGlmICggISBhbGxTaG93ZWQpIHJldHVyblxyXG5cclxuXHJcbiAgICAgICAgc2xpY2VyLmluZGV4ZXMgPSB7IHN0YXJ0OiBzbGljZXIuZGF0YS5sZW5ndGggLSAxLCBlbmQ6IHNsaWNlci5kYXRhLmxlbmd0aCB9O1xyXG4gICAgICAgIHNsaWNlci5hZGRTbGljZWRDb21tZW50cygnI21haW4tY29tbWVudHMnKTtcclxuICAgICAgICBTaG93SXQuc21vb3RoU2hvd1NsaWNlZEVsZW1lbnRzKCcucnQtY29tbWVudHMgPiAucnQtY29tbWVudCcsIHNsaWNlci5pbmRleGVzLCAwLjUpO1xyXG4gICAgfSlcclxuICAgIC8vIDwtLS0tIFRFWFRBUkVBXHJcblxyXG4gICAgLy8gQ09NTUVOVFMgLS0tLT5cclxuICAgIGNvbnN0IGNvbW1lbnRzID0gW107XHJcbiAgICAkLmdldCgnLi4vZGF0YWJhc2UvY29tbWVudHMvY29tbWVudHMuanNvbicsIHt9LCAoZGF0YSkgPT4ge1xyXG5cclxuICAgICAgICAkKGRhdGEpLmVhY2goKGluZGV4LCBjb21tZW50UHJvcHMpID0+IHtcclxuICAgICAgICAgICAgaWYgKGNvbW1lbnRQcm9wcy5ib29rSWQgIT09IGN1cnJlbnRCb29rSWQpIHJldHVyblxyXG4gICAgICAgICAgICBjb21tZW50cy5wdXNoKG5ldyBDb21tZW50KGNvbW1lbnRQcm9wcykpO1xyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIHNsaWNlci5kYXRhID0gY29tbWVudHM7XHJcbiAgICAgICAgc2xpY2VyLmFkZFNsaWNlZENvbW1lbnRzKCcucnQtY29tbWVudHMnKTtcclxuICAgICAgICBTaG93SXQuc21vb3RoU2hvd1NsaWNlZEVsZW1lbnRzKCcucnQtY29tbWVudCcsIHNsaWNlci5pbmRleGVzLCAwLjUpO1xyXG5cclxuICAgICAgICBcclxuICAgIH0pXHJcbiAgICAvLyA8LS0tLSBDT01NRU5UU1xyXG5cclxuICAgIC8vIFNIT1cgTU9SRSBDT01NRU5UUyAtLS0tPlxyXG4gICAgJCgnYnV0dG9uI3Nob3ctbW9yZS1jb21tZW50cycpLm9uKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICBzbGljZXIuaW5kZXhlcyA9IHsgc3RhcnQ6IHNsaWNlci5pbmRleGVzLmVuZCwgZW5kOiBzbGljZXIuaW5kZXhlcy5lbmQgKyA1IH07XHJcbiAgICAgICAgc2xpY2VyLmFkZFNsaWNlZENvbW1lbnRzKCcucnQtY29tbWVudHMnKTtcclxuICAgICAgICBTaG93SXQuc21vb3RoU2hvd1NsaWNlZEVsZW1lbnRzKCcucnQtY29tbWVudCcsIHNsaWNlci5pbmRleGVzLCAwLjUpO1xyXG5cclxuICAgICAgICBpZiAoc2xpY2VyLmluZGV4ZXMuZW5kIDw9IHNsaWNlci5kYXRhLmxlbmd0aCkgcmV0dXJuXHJcbiAgICAgICAgYWxsU2hvd2VkID0gdHJ1ZTtcclxuICAgIH0pXHJcbiAgICAvLyA8IC0tLS0gU0hPVyBNT1JFIENPTU1FTlRTXHJcblxyXG4gICAgJCgnLnJ0LWNoYXB0ZXJfX2xpbmsnKS5vbignY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICAgIGNvbnN0IGNoYXB0ZXJOdW0gPSAkKCcucnQtY2hhcHRlcl9fbnVtJywgJCh0aGlzKSkudGV4dCgpO1xyXG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdjaGFwdGVyTnVtJywgY2hhcHRlck51bSk7XHJcblxyXG4gICAgICAgIGRvY3VtZW50LmxvY2F0aW9uLmhyZWYgPSBcImNoYXB0ZXIuaHRtbFwiO1xyXG4gICAgfSlcclxuXHJcblxyXG4gICAgLy8gR1JBREUgLS0tLT5cclxuICAgIG5ldyBNb2RhbCh7XHJcbiAgICAgICAgc3RhcnM6IHRydWUsXHJcbiAgICAgICAgbmFtZTogJ2dyYWRlJ1xyXG4gICAgfSkuY3JlYXRlKCk7XHJcbiAgICAvLyA8LS0tLSBHUkFERVxyXG59KSJdfQ==
